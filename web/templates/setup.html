{% extends "base.html" %}
{% block title %}Setup{% endblock %}
{% block body %}
<div class="auth-page">
    <div class="auth-card">
        <div class="auth-brand">
            <img src="/static/logo-192.png" alt="Logo">
            <div><h2>CISIA CRAWLER</h2><small>Admin Panel Setup</small></div>
        </div>
        {% with messages = get_flashed_messages(with_categories=true) %}{% for c, m in messages %}<div class="flash flash-{{ c }}">{{ m }}</div>{% endfor %}{% endwith %}
        <h3 style="font-size:15px;font-weight:600;margin-bottom:18px">Create Admin Account</h3>
        <form method="POST">
            <div class="form-group"><label>Password</label><input type="password" name="password" required minlength="6" placeholder="Min 6 characters"></div>
            <div class="form-group"><label>Confirm Password</label><input type="password" name="confirm" required placeholder="Repeat password"></div>
            <div class="section-title" style="margin-top:20px">Two-Factor Authentication</div>
            <p style="font-size:12px;color:var(--text-muted);margin-bottom:14px">Scan the QR code with your authenticator app (Google Authenticator, Authy, etc.)</p>
            <div style="text-align:center;margin-bottom:14px"><img src="https://api.qrserver.com/v1/create-qr-code/?size=180x180&data={{ totp_uri|urlencode }}" style="border-radius:8px;border:1px solid var(--border)"></div>
            <div class="secret-box">{{ totp_secret }}</div>
            <input type="hidden" name="totp_secret" value="{{ totp_secret }}">
            <div class="form-group"><label>Verification Code</label><input type="text" name="totp_code" class="mono-input" required placeholder="6-digit code" maxlength="6" autocomplete="off" inputmode="numeric"><div class="hint">Enter code from your authenticator app.</div></div>
            <button type="submit" class="btn btn-red" style="width:100%;margin-top:6px">Create Account</button>
        </form>
    </div>
</div>
{% endblock %}
